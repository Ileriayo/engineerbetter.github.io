<!doctype html><html lang=pl><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><title>cf-for-k8s, KubeCF, Kf | EngineerBetter | More than Cloud Platform specialists</title><link rel=stylesheet href="/css/main.css?v=4"><link rel=stylesheet href=/css/syntax.css><link rel=icon type=image/png href=/img/favicon.png><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-74442484-1","auto"),ga("send","pageview")</script><script src=//load.sumome.com/ data-sumo-site-id=7c63408cd1c29faa63d20123ff629d524df6674695e4305a0e602f2bbf431038 async></script>
<script type=text/javascript>var _iub=_iub||[];_iub.csConfiguration={banner:{textColor:"#dadada",backgroundColor:"#5A5A5A"},lang:"en",siteId:939573,cookiePolicyId:8251825}</script><script type=text/javascript src=//cdn.iubenda.com/cookie_solution/safemode/iubenda_cs.js async></script></head><body><section id=menu-nav-top class="menu fixed-menu clearfix"><div class=menu_contact><p class=menu_contact-number>+44 (0) 20 7846 0140</p><a href=mailto:contact@engineerbetter.com class=menu_contact-us>Contact us</a></div><div class="menu_header clearfix"><button class=menu_header-button>
<span class="icon-bar top-bar"></span>
<span class="icon-bar middle-bar"></span>
<span class="icon-bar bottom-bar"></span></button>
<a href=/ class=menu_header-logo><img class=logo-header-img alt=Brand src=/img/engineer-better-logo.svg></a></div></section><div class=menu_list><button class=menu_list-close><p>&#x2716;</p></button><div class=menu_list-inner-wrap><p class=menu_list-phone>+44 (0) 20 7846 0140</p><a class=menu_list-contact-btn href=mailto:contact@engineerbetter.com>Contact us&nbsp;<span>&#xe900;</span></a><ul class=menu_list-links><li><a href=/how-we-work/>How we work</a></li><li><a href=/our-services/>Our services</a></li><li><a href=/success-stories/>Success stories</a></li><li><a href=/why-cloud-native/>why cloud-native?</a></li><li><a href=/about-us/>About us</a></li><li><a href=/blog/>Blog</a></li></ul><div class=menu_list-icons><a href=https://twitter.com/EngineerBetter><img src=/img/twitter.svg alt="Twitter profile"></a>
<a href=https://github.com/EngineerBetter><img src=/img/github.svg alt="Github profile"></a></div><div class=menu_list-bot-menu><a href=/blog/>Blog</a><span>|</span><a href=/join-our-team/>Careers</a><span>|</span><a href=//www.iubenda.com/privacy-policy/8251825 class="iubenda-nostyle no-brand iubenda-embed" title="Privacy Policy">Privacy</a><script type=text/javascript>(function(e,t){var n=function(){var e=t.createElement("script"),n=t.getElementsByTagName("script")[0];e.src="//cdn.iubenda.com/iubenda.js",n.parentNode.insertBefore(e,n)};e.addEventListener?e.addEventListener("load",n,!1):e.attachEvent?e.attachEvent("onload",n):e.onload=n})(window,document)</script></div></div></div><section class="menu-banner-top_wrap parallax is-page"><div class=menu-banner-top><div class=menu-banner-top_contact><a class=menu-banner-top_number href="tel:+44 (0) 20 7846 0140">+44 (0) 20 7846 0140</a>
<a class=menu-banner-top_contact-us href=mailto:contact@engineerbetter.com>Contact us</a></div><div class=menu-banner-top_btn-wrap><button class=menu_header-button>
<span class="icon-bar top-bar"></span>
<span class="icon-bar middle-bar"></span>
<span class="icon-bar bottom-bar"></span></button></div><div class="menu-banner-top_logo clearfix"><a href=/ class=home-banner_logo-img><img class=logo-img alt=Brand src=/img/engineer-better-logo.svg></a></div></div><div class=home-banner><div class="home-banner_list clearfix"><div class=home-banner_list-category><ul><li><a href=ileri.com/how-we-work/>How we work</a></li><li><a href=ileri.com/our-services/>Our services</a></li><li><a href=ileri.com/success-stories/>Success Stories</a></li><li><a href=ileri.com/why-cloud-native/>Why Cloud-Native?</a></li><li><a href=ileri.com/about-us/>About us</a></li><li><a href=ileri.com/blog/>Blog</a></li></ul></div><div class=home-banner_textarea><h1 class=home-banner_textarea-header>Our <strong>blog&nbsp;<span>&#xe900;</span></strong></h1><div class=home-banner_textarea-wrap><p class=home-banner_textarea-description>Get the very latest updates about recent projects, team updates, thoughts and industry news from our team of EngineerBetter experts.</p></div></div></div></div></section><section class=blog-page><div class=blog-page_container><h1>cf-for-k8s, KubeCF, Kf</h1><p class=blog-page_details>Jan 28, 2021<span>|</span> Daniel Jones</p><div class=blog-page_image><img src=/img/blog/cf-standoff.jpg></div><p>There is no single obvious choice for those evaluating Kubernetes-based Cloud Foundry distributions and alternatives. Find out why <strong>EngineerBetter chose Google&rsquo;s Kf</strong> for our estate, and why our <strong>advice to existing Cloud Foundry users is &ldquo;stay on BOSH</strong>.&rdquo;</p><p>In January VMware shut down their public Cloud Foundry (Pivotal Web Services). All of EngineerBetter&rsquo;s apps ran on PWS and so we needed to migrate away from the platform and find something equally cheap and simple.</p><p>Our choices were:</p><ul><li>cf-for-k8s</li><li>KubeCF</li><li>Google&rsquo;s Kf</li></ul><p>We&rsquo;ll get back to the narrative of our own experiences at the end of the post, and instead focus on a comparison of the tools.</p><h2 id=cf-for-k8s>cf-for-k8s</h2><p><a href=https://github.com/cloudfoundry/cf-for-k8s>cf-for-k8s</a> drops many features, whilst taking the approach of &ldquo;maintain CLI/API compatibility and replace the internals with cloud-native equivalents.&rdquo; For example the Cloud Controller stays, routing is implemented with <a href=https://github.com/istio/istio>Istio</a>, logging with <a href=https://www.fluentd.org/>Fluentd</a>, and staging with VMware&rsquo;s <a href=https://github.com/pivotal/kpack>kpack</a>.</p><p>cf-for-k8s is spearheaded by VMware. Despite appearing in the main Cloud Foundry GitHub org, cf-for-k8s is in fact an incubation project.</p><h3 id=how-is-it-implemented>How is it implemented?</h3><ul><li>Replaces almost all of Cloud Foundry with new components</li><li>Retains the Cloud Controller, for API compatibility</li><li>Deployed using <a href=https://carvel.dev/>Carvel</a>, VMware&rsquo;s open source Kubernetes tooling that has little adoption elsewhere</li></ul><h3 id=how-compatible-is-it>How compatible is it?</h3><p>cf-for-k8s would <strong>fail <a href=https://www.cloudfoundry.org/certified-platforms-how-to/>Cloud Foundry Provider Certification</a></strong>. The community maintains <a href="https://docs.google.com/document/d/1X5AUpM0eK5z_4yWJk35HqrCFJRVjS7kRJsRxsf-7dsM/view#heading=h.set0zeyyi2jw">a list of <strong>unsupported</strong> features</a>:</p><ul><li>Existing <em>not-cloud-native</em> buildpacks</li><li>Container-to-container networking</li><li>Route services</li><li>TCP routing</li><li>Isolation Segments</li><li>App instance routing</li><li><code>cf ssh</code></li><li>Developer-specified buildpacks (ie via <code>cf push -b</code>)</li></ul><p>My personal take is that the project would be more appropriately-named &ldquo;<em>something-that-is-a-lot-like-cf-for-k8s</em>.&rdquo;</p><h3 id=is-it-ready-yet>Is it ready yet?</h3><p>No. The commercial version (the snappily-named <a href=https://docs.pivotal.io/tas-kubernetes/0-7/index.html><em>Tanzu Application Service for Kubernetes</em></a>) has been released only as a technical preview.</p><h3 id=can-i-buy-it>Can I buy it?</h3><p>No.</p><h3 id=what-about-the-future>What about the future?</h3><p>VMware are publicly committed to cf-for-k8s.</p><p>I would invite readers to consider the amount of <a href=https://github.com/cloudfoundry/cf-for-k8s/pulse>activity on the relevant GitHub repositories</a>, and to see how predominantly <em>TAS for Kubernetes</em> features in VMware Tanzu sales pitches and marketing materials. Search results point to reference documentation and a download page, but no shiny marketing material. VMware employees have recently been showing increasing interest in KubeCF on the Cloud Foundry Foundation Slack.</p><h2 id=kubecf>KubeCF</h2><p><a href=https://github.com/cloudfoundry-incubator/kubecf>KubeCF</a> uses complex tooling to deploy the exact-same Cloud Foundry components used currently onto Kubernetes. You can think of its approach as &ldquo;take what we have, deploy it on Kubes.&rdquo;</p><p>KubeCF has had most contributions from SUSE, IBM and HCL.</p><h3 id=how-is-it-implemented-1>How is it implemented?</h3><ul><li>All the current Cloud Foundry components, repackaged for Kubernetes</li><li>Uses Fissile to turn cf-deployment BOSH releases into container images</li><li>Deployed using Quarks, a set of operators</li><li>The myriad controllers and init containers can be <em>very</em> hard to debug</li></ul><h3 id=how-compatible-is-it-1>How compatible is it?</h3><ul><li><strong>Almost all features work</strong> including uncommon ones like sidecar containers, and container-to-container networking</li><li>Route services are not supported</li><li>Isolation segments are not supported</li></ul><h3 id=is-it-ready-yet-1>Is it ready yet?</h3><p>Yes. IBM are running it in production, SUSE have customers running it in production, and we know folks that have been running KubeCF instances for over a year without problems.</p><h3 id=can-i-buy-it-1>Can I buy it?</h3><p>Go and ask SUSE if you can buy their <a href=https://www.suse.com/products/cloud-application-platform/>Cloud Application Platform</a>. I suspect you&rsquo;ll get a sales pitch for <a href=https://rancher.com/products/rke/>Rancher&rsquo;s RKE</a>.</p><h3 id=what-about-the-future-1>What about the future?</h3><p>IBM depend on KubeCF for their production offerings.</p><p>I would invite readers to ponder whether the expensive Rancher acquisition made by SUSE incentivises them to continue selling Cloud Foundry. What is the <a href=https://github.com/SUSE/carrier>Carrier</a> project recently started by SUSE, involving the folks who have been working on KubeCF?</p><p>Again, look at the <a href=https://github.com/cloudfoundry-incubator/kubecf/pulse>activity on the GitHub repos</a>, and most importantly, see if you can get SUSE to sell you a CAP.</p><h2 id=kf>Kf</h2><p><a href=https://cloud.google.com/migrate/kf/docs>Kf</a> is a set of components made by Google Cloud and offered as part of their Anthos suite. It offers a core developer experience that is similar to using the CF CLI with a completely new and Kubernetes-native backend. Kf does not intend to implement all the features of Cloud Foundry, rather the core app-pushing experience.</p><p>Kf <a href=https://web.archive.org/web/20200503213544/github.com/google/kf>started life as an open source project</a> before <a href=https://web.archive.org/web/20200905050558/github.com/google/kf>being made closed source</a>, presumably for the sake of competitive advantage or due to lack of engagement from other Cloud Foundry Foundation members.</p><h3 id=how-is-it-implemented-2>How is it implemented?</h3><ul><li>A combination of a CLI, Anthos components, and custom Kubernetes controllers</li><li>It&rsquo;s all currently closed-source, proprietary Google code</li><li>As everything is Kubernetes-native one can debug the entire system with <code>kubectl</code> alone</li></ul><h3 id=how-compatible-is-it-2>How compatible is it?</h3><ul><li>The <code>kf</code> CLI is not a like-for-like match for the <code>cf</code> CLI</li><li>Currently a lot of features are not implemented, but core app-pushing is</li><li>Old-school buildpacks are supported</li><li>There is no Cloud Controller, so other non-CLI interactions will not work (eg Stratos)</li><li>There are some restrictions on app and domain names (eg app names cannot start with a numeral, no <code>www.</code> as a host)</li><li>Google are working on a migration tool</li></ul><h3 id=is-it-ready-yet-2>Is it ready yet?</h3><p>Yes. We decided to run all our Cloud Foundry apps on GKE using <code>kf</code>. In fact, this very page was served by a <code>kf</code> app!</p><p>Given some of the scaling limitations of Kubernetes itself, operators should expect to break one large Cloud Foundry into smaller <code>kf</code> Kubernetes clusters.</p><h3 id=can-i-buy-it-2>Can I buy it?</h3><p>Yes, and Kf is offered <a href=https://cloud.google.com/migrate/kf/docs/resources/pricing>at no additional cost beyond Anthos Service Mesh and GKE</a>. <a href="https://cloud.withgoogle.com/partners/detail/?id=engineerbetter&amp;hl=en-GB">EngineerBetter as Google Cloud partners</a> can also help you with Kf adoption.</p><h3 id=what-about-the-future-2>What about the future?</h3><p>Google continue to invest in <code>kf</code> and Product Manager Micah Baker has publicly mentioned a feature roadmap stretching out at least a year.</p><h2 id=our-experience>Our experience</h2><p>We needed to migrate away from PWS before 15th January 2021. Our estate comprised around 15 static web applications, and a few Ruby apps. Some of these needed Redis and Postgres data services.</p><p>The team enthusiastically started off using cf-for-k8s. After more than a week of effort, we concluded that it was not ready for real-world use.</p><p>Whilst cf-for-k8s makes starting a development environment trivial, it does not offer the feature toggles required for a production deployment. A lot of the conveniences in cf-deployment&rsquo;s ops files are missing.</p><p>The lack of old-school buildpacks was an absolute showstopper for us. There weren&rsquo;t CNB equivalents available, and even if there were, they probably would not have yielded identical results.</p><p>Comments from our engineers included &ldquo;this is <em>so</em> not ready&rdquo; and &ldquo;this feels like an alpha.&rdquo; They did like the use of Istio and Fluentd, however.</p><p>We&rsquo;ve used KubeCF before, and have delivered training on how to install and operate it. Given the small number of apps that we have, and our lack of need for multi-tenancy, the debugging overhead of all the Quarks-spawned init containers felt like something we should avoid.</p><p>Kf was the simplest approach given our low app count (fewer than 20). Whilst we encountered a few gotchas (see the limitations on app and domain names above) it was great that old-school buildpacks are supported (as well as CNBs). The operational overhead is minimal, and the effort to change our CI pipelines was pretty minimal.</p><p>As one of our engineers commented: &ldquo;Kf is how I wish cf-for-k8s had been implemented.&rdquo; All state is in the kube-api, meaning everything is debuggable with <code>kubectl</code>.</p><h2 id=what-should-i-do>What should I do?</h2><p>If you&rsquo;re an existing BOSH-deployed Cloud Foundry operator who does not have a pressing need to make changes, <strong>I strongly suggest that you continue using BOSH and cf-deployment</strong>.</p><p>If you&rsquo;re using BOSH-deployed Cloud Foundry and are concerned about the dwindling pool of BOSH talent to operate your environment, then you have three options:</p><ul><li>use <code>kf</code> on any Anthos-connected cluster, and slowly migrate to a Kubernetes-native workflow</li><li>use KubeCF and hope that the project will be maintained</li><li>wait and hope that a truly Kubernetes-native evolution of Cloud Foundry becomes available and is production-ready</li></ul><p>I don&rsquo;t see any use cases for which cf-for-k8s is the ideal solution. This is unfortunate, as I already know a bunch of operators who have spent time evaluating it and drawn the same conclusion - it&rsquo;s not ready yet.</p><h2 id=wait-bosh>Wait, BOSH?</h2><p>Wasn&rsquo;t 2021 supposed to be the year of Cloud Foundry&rsquo;s second wind? Bringing the CF experience to the masses of Kubernetes operators who found building their own platform too costly? It seems like, via a self-fulfilling prophecy of strategic decisions, the future of Cloud Foundry is BOSH.</p><p>I think we were all hoping for open source users to be able to ride in the coat-tails of a fully-committed commercial distribution built on top of Kubernetes. The current state of Cloud Foundry is a reminder that open source software comes with risks and responsibilities. If you want stability and assurances, then best speak to a vendor.</p><p>For now, open source users are advised to wait until the dust settles. Like most things in 2020, the volatility seems to be going on longer than anyone expected.</p><h2 id=isnt-there-anything-else>Isn&rsquo;t there anything else?</h2><p>We&rsquo;ve not found anything that matches the Cloud Foundry experience. Yes, the imperative <code>cf</code> CLI is an anachronism in the world of GitOps. But Cloud Foundry is more than that - it&rsquo;s the sum of all the assurances made to operators too. The simplicity of having a batteries-included platform; being able to rebuild container images long after app teams have disbanded; a curated marketplace of dynamically-provisioned data services; a sensible RBAC model; security-by-default; years of production-hardening in regulated, governmental and military environments.</p><p>There are great tools out there like <a href=https://devspace.sh/>DevSpace</a>. The big vendors are all interested in building something proprietary on top of Knative. We&rsquo;re yet to find something as vendor-neutral and feature-complete as Cloud Foundry.</p><p>If it ain&rsquo;t broke, don&rsquo;t fix it. The innards of Cloud Foundry are antiquated. Fewer and fewer people will be able to support BOSH. However, <strong>there is not yet a &rsquo;no-brainer&rsquo; replacement</strong> that my peers (in other consultancies - we talk a lot) and I can recommend.</p><p>Kubernetes is the substrate on which all cloud platforms will be built. <a href=https://github.com/EngineerBetter/k8s-is-not-a-paas>Kubernetes is not a PaaS</a>. I wish vendors had moved Cloud Foundry onto Kubernetes sooner. Goodness knows, <a href=https://blogs.cisco.com/cloud/containerized-cloud-foundry-is-key-element-for-cloud-native>Cisco</a> and <a href=https://twitter.com/sramji/status/1331275042647228416>the team that joined SUSE</a> tried.</p><blockquote></blockquote><p>Five years ago I made an invitation to deliver technology in a way that most respected the expended heartbeats of those around you.</p><ul><li>Which path ahead saves your organisation the most toil and expense?</li><li>At what point do antiquated internals present a bigger risk than the cost of homebrewing a platform?</li><li>How much more important are business outcomes than using the coolest new tech?</li></ul><p>I look forward to continuing my involvement in the <a href=https://lists.cncf.io/g/cncf-business-value>CNCF Business Value Subcommittee</a>, to ensure the passion and learnings of the Cloud Foundry community continue to have a broad and meaningful impact.</p></div><div class="blog-page_banner clearfix"><div class=blog_banner-text><h2>Get in touch</h2><p>See how much we can help you.<br>Call <span>+44 (0) 20 7846 0140</span> or</br></p><a href=mailto:contact@engineerbetter.com class=cloud-btn2><p>Contact us <span>&#xe900;</span></p></a></div></div></section><footer><div class=footer-background></div><div class="footer_wrap clearfix"><div class=footer_column-list-desktop><ul class=list><li><a href=/how-we-work/><span>&mdash;</span> How we work</a></li><li><a href=/our-services/><span>&mdash;</span> Our services</a></li><li><a href=/success-stories/><span>&mdash;</span> Success stories</a></li><li><a href=/why-cloud-native/><span>&mdash;</span> Why Cloud-Native?</a></li><li><a href=/about-us/><span>&mdash;</span> About us</a></li></ul></div><div class=footer_column-list><ul class=list><li><a href=mailto:contact@engineerbetter.com><span>&mdash;</span> Contact us</a></li><li><a href=/blog/><span>&mdash;</span> Blog</a></li><li><a href=/join-our-team/><span>&mdash;</span> Join our team</a></li><li><a href=//www.iubenda.com/privacy-policy/8251825 class="iubenda-nostyle no-brand iubenda-embed" title="Privacy Policy"><span>&mdash;</span> Privacy Policy</a><script type=text/javascript>(function(e,t){var n=function(){var e=t.createElement("script"),n=t.getElementsByTagName("script")[0];e.src="//cdn.iubenda.com/iubenda.js",n.parentNode.insertBefore(e,n)};e.addEventListener?e.addEventListener("load",n,!1):e.attachEvent?e.attachEvent("onload",n):e.onload=n})(window,document)</script></li></ul></div><div class=footer_column-icon-wrap><a href=https://twitter.com/EngineerBetter class=footer_column-icon><img class=footer_column-icon-img alt=Brand src=/img/icon-twitter.png></a>
<a href=https://github.com/EngineerBetter class=footer_column-icon><img class=footer_column-icon-img alt=Brand src=/img/icon-git-hub.png></a></div><div class=footer_column-text><p>&copy; Copyright EngineerBetter Ltd</p><p>Registered England & Wales 10141478</p></div></div></footer><script src="/js/jquery-1.11.3.min.js?v=4"></script>
<script src=/js/site.js></script></body></html>