<!doctype html><html lang=pl><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><title>Deploying Kubernetes with BOSH | EngineerBetter | More than Cloud Platform specialists</title><link rel=stylesheet href="/css/main.css?v=4"><link rel=stylesheet href=/css/syntax.css><link rel=icon type=image/png href=/img/favicon.png><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-74442484-1","auto"),ga("send","pageview")</script><script src=//load.sumome.com/ data-sumo-site-id=7c63408cd1c29faa63d20123ff629d524df6674695e4305a0e602f2bbf431038 async></script>
<script type=text/javascript>var _iub=_iub||[];_iub.csConfiguration={banner:{textColor:"#dadada",backgroundColor:"#5A5A5A"},lang:"en",siteId:939573,cookiePolicyId:8251825}</script><script type=text/javascript src=//cdn.iubenda.com/cookie_solution/safemode/iubenda_cs.js async></script></head><body><section id=menu-nav-top class="menu fixed-menu clearfix"><div class=menu_contact><p class=menu_contact-number>+44 (0) 20 7846 0140</p><a href=mailto:contact@engineerbetter.com class=menu_contact-us>Contact us</a></div><div class="menu_header clearfix"><button class=menu_header-button>
<span class="icon-bar top-bar"></span>
<span class="icon-bar middle-bar"></span>
<span class="icon-bar bottom-bar"></span></button>
<a href=/ class=menu_header-logo><img class=logo-header-img alt=Brand src=/img/engineer-better-logo.svg></a></div></section><div class=menu_list><button class=menu_list-close><p>&#x2716;</p></button><div class=menu_list-inner-wrap><p class=menu_list-phone>+44 (0) 20 7846 0140</p><a class=menu_list-contact-btn href=mailto:contact@engineerbetter.com>Contact us&nbsp;<span>&#xe900;</span></a><ul class=menu_list-links><li><a href=/how-we-work/>How we work</a></li><li><a href=/our-services/>Our services</a></li><li><a href=/success-stories/>Success stories</a></li><li><a href=/why-cloud-native/>why cloud-native?</a></li><li><a href=/about-us/>About us</a></li><li><a href=/blog/>Blog</a></li></ul><div class=menu_list-icons><a href=https://twitter.com/EngineerBetter><img src=/img/twitter.svg alt="Twitter profile"></a>
<a href=https://github.com/EngineerBetter><img src=/img/github.svg alt="Github profile"></a></div><div class=menu_list-bot-menu><a href=/blog/>Blog</a><span>|</span><a href=/join-our-team/>Careers</a><span>|</span><a href=//www.iubenda.com/privacy-policy/8251825 class="iubenda-nostyle no-brand iubenda-embed" title="Privacy Policy">Privacy</a><script type=text/javascript>(function(e,t){var n=function(){var e=t.createElement("script"),n=t.getElementsByTagName("script")[0];e.src="//cdn.iubenda.com/iubenda.js",n.parentNode.insertBefore(e,n)};e.addEventListener?e.addEventListener("load",n,!1):e.attachEvent?e.attachEvent("onload",n):e.onload=n})(window,document)</script></div></div></div><section class="menu-banner-top_wrap parallax is-page"><div class=menu-banner-top><div class=menu-banner-top_contact><a class=menu-banner-top_number href="tel:+44 (0) 20 7846 0140">+44 (0) 20 7846 0140</a>
<a class=menu-banner-top_contact-us href=mailto:contact@engineerbetter.com>Contact us</a></div><div class=menu-banner-top_btn-wrap><button class=menu_header-button>
<span class="icon-bar top-bar"></span>
<span class="icon-bar middle-bar"></span>
<span class="icon-bar bottom-bar"></span></button></div><div class="menu-banner-top_logo clearfix"><a href=/ class=home-banner_logo-img><img class=logo-img alt=Brand src=/img/engineer-better-logo.svg></a></div></div><div class=home-banner><div class="home-banner_list clearfix"><div class=home-banner_list-category><ul><li><a href=ileri.com/how-we-work/>How we work</a></li><li><a href=ileri.com/our-services/>Our services</a></li><li><a href=ileri.com/success-stories/>Success Stories</a></li><li><a href=ileri.com/why-cloud-native/>Why Cloud-Native?</a></li><li><a href=ileri.com/about-us/>About us</a></li><li><a href=ileri.com/blog/>Blog</a></li></ul></div><div class=home-banner_textarea><h1 class=home-banner_textarea-header>Our <strong>blog&nbsp;<span>&#xe900;</span></strong></h1><div class=home-banner_textarea-wrap><p class=home-banner_textarea-description>Get the very latest updates about recent projects, team updates, thoughts and industry news from our team of EngineerBetter experts.</p></div></div></div></div></section><section class=blog-page><div class=blog-page_container><h1>Deploying Kubernetes with BOSH</h1><p class=blog-page_details>Nov 20, 2017<span>|</span> Will Gant, Sapphire Mason-Brown</p><div class=blog-page_image><img src=/img/blog/deploying-kubernetes-with-bosh.jpg></div><p>As the popularity of containerization continues to rise, so too has the use of services like Kubernetes, which automate deployment, scaling and management of applications by development teams. But what happens when a core component of your Kubernetes cluster suddenly fails?</p><p>In a traditional scenario, the death of a sickly Kubernetes node would have to be brought to the attention of a platform operator, who would then have to follow a number of manual (and not always fully documented) steps to bring it back to life. Since March this year, additional resilience has been offered in the form of Cloud Foundry Container Runtime (CFCR)(<a href=https://docs-kubo.cfapps.io/)>https://docs-kubo.cfapps.io/)</a>, which makes Kubernetes available as a BOSH release. Formerly known as Kubo, CFCR is a collaboration between Pivotal and Google, who have since donated the project to the Cloud Foundry Foundation.</p><p>Just as with Cloud Foundry, BOSH takes care of the deployment of the platform, while also monitoring its health, spinning up new virtual machines and installing updates as required. To make clusters even more resilient to unexpected failures, BOSH can also deploy CFCR over multiple different cloud providers and even alongside a Cloud Foundry deployment.</p><h2 id=deploying-apps-in-a-cluster>Deploying apps in a cluster</h2><p>A cluster is made up of at least one master and one worker node. An additional third node (etcd) records the state of the cluster - which nodes exist, which ‘pods’ should be running, and where. Each pod sits on a worker node, and represents one or more containers that share system resources and IP addresses. The outside world communicates with the cluster through the Kubernetes API, which sits behind a load balancer.</p><p>When a developer wants to push a containerized app, they can run the <code>kubectl run</code> command:</p><p><code>kubectl run &lt;APP-NAME> &lt;IMAGE></code></p><p>For example <code>kubectl run hello-world --image=gcr.io/google-samples/node-hello:1.0</code>.</p><p>To view the details of new deployment, run <code>kubectl describe deployment &lt;APP-NAME></code>.</p><p>Kubernetes apps run in pods on worker nodes.</p><p>Once your app is up and running, you can easily scale the number of running instances, and expose it externally through the kubectl CLI.</p><h2 id=platform-deployment>Platform deployment</h2><p>In order to get your CFCR cluster setup on AWS (the infrastructure provider we chose), the first step is downloading and expanding the official Kubo Deployment tarball. This can be used to terraform a bastion/jump box VM, from which the CFCR deployment is ultimately made. After some configuration, we run <code>deploy_bosh</code> to create our BOSH director, and do some further terraforming to create an AWS load balancer that will handle routing for our cluster. After this, it’s just a case of running a couple of scripts to deploy CFCR itself and set up its command line interface.</p><p>We went through the setup process a few times, and think it’s realistic to expect to go from zero to running a ‘hello world’ app in under an hour (though the official guide could be improved - we were tripped up a few times by some inconsistent naming of environmental variables).</p><p>Whilst the deployment instructions give you what you need to make the initial deployment of BOSH, the uninitiated will need to gain at least a fundamental understanding of what BOSH does, along with some core CLI commands. For instance, while testing the limits of what BOSH was capable of - by terminating all but two of our CFCR nodes in the AWS console - we managed to break our deployment, but were able to inspect our VMs with BOSH before using the director to put our dying cluster out of its misery as a precursor to redeployment.</p><p>Many aspect of the developer experience will be familiar to existing users of Cloud Foundry, though, because of the nature of containerized deployment, the process of pushing an app is a little more involved. While a beta version is expected soon, there is also currently no equivalent to the CF marketplace for provisioning services such as databases, and binding them to applications.</p><p>CFCR is still in its infancy, with some key components under development. Kubernetes itself dominates the container orchestration market, as the tool chosen by more than 40% of businesses in this year’s <a href=https://portworx.com/wp-content/uploads/2017/04/Portworx_Annual_Container_Adoption_Survey_2017_Report.pdf>Annual Container Adoption Survey</a>. However, <a href="https://cloudfoundry.org/container-report-2017/?utm_source=pr&amp;utm_campaign=cr17&amp;utm_content=cff">a report by</a> the Cloud Foundry Foundation found an increase from just 22% to 25% of firms making use of containers between 2016 and 2017. With its ease of deployment and built-in lifecycle management, the resilience offered by CFCR will give operators greater confidence to run production workloads in containers.</p></div><div class="blog-page_banner clearfix"><div class=blog_banner-text><h2>Get in touch</h2><p>See how much we can help you.<br>Call <span>+44 (0) 20 7846 0140</span> or</br></p><a href=mailto:contact@engineerbetter.com class=cloud-btn2><p>Contact us <span>&#xe900;</span></p></a></div></div></section><footer><div class=footer-background></div><div class="footer_wrap clearfix"><div class=footer_column-list-desktop><ul class=list><li><a href=/how-we-work/><span>&mdash;</span> How we work</a></li><li><a href=/our-services/><span>&mdash;</span> Our services</a></li><li><a href=/success-stories/><span>&mdash;</span> Success stories</a></li><li><a href=/why-cloud-native/><span>&mdash;</span> Why Cloud-Native?</a></li><li><a href=/about-us/><span>&mdash;</span> About us</a></li></ul></div><div class=footer_column-list><ul class=list><li><a href=mailto:contact@engineerbetter.com><span>&mdash;</span> Contact us</a></li><li><a href=/blog/><span>&mdash;</span> Blog</a></li><li><a href=/join-our-team/><span>&mdash;</span> Join our team</a></li><li><a href=//www.iubenda.com/privacy-policy/8251825 class="iubenda-nostyle no-brand iubenda-embed" title="Privacy Policy"><span>&mdash;</span> Privacy Policy</a><script type=text/javascript>(function(e,t){var n=function(){var e=t.createElement("script"),n=t.getElementsByTagName("script")[0];e.src="//cdn.iubenda.com/iubenda.js",n.parentNode.insertBefore(e,n)};e.addEventListener?e.addEventListener("load",n,!1):e.attachEvent?e.attachEvent("onload",n):e.onload=n})(window,document)</script></li></ul></div><div class=footer_column-icon-wrap><a href=https://twitter.com/EngineerBetter class=footer_column-icon><img class=footer_column-icon-img alt=Brand src=/img/icon-twitter.png></a>
<a href=https://github.com/EngineerBetter class=footer_column-icon><img class=footer_column-icon-img alt=Brand src=/img/icon-git-hub.png></a></div><div class=footer_column-text><p>&copy; Copyright EngineerBetter Ltd</p><p>Registered England & Wales 10141478</p></div></div></footer><script src="/js/jquery-1.11.3.min.js?v=4"></script>
<script src=/js/site.js></script></body></html>